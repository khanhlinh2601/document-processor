{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.204.0"},"children":{"DocumentProcessing-dev":{"id":"DocumentProcessing-dev","path":"DocumentProcessing-dev","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.204.0"},"children":{"DocumentStorage":{"id":"DocumentStorage","path":"DocumentProcessing-dev/DocumentStorage","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"DocumentBucket":{"id":"DocumentBucket","path":"DocumentProcessing-dev/DocumentStorage/DocumentBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/DocumentStorage/DocumentBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"document-processing-dev-519610608202","corsConfiguration":{"corsRules":[{"maxAge":3000,"allowedHeaders":["*"],"allowedMethods":["GET","PUT","POST","HEAD"],"allowedOrigins":["*"]}]}}}},"Notifications":{"id":"Notifications","path":"DocumentProcessing-dev/DocumentStorage/DocumentBucket/Notifications","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/DocumentStorage/DocumentBucket/Notifications/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.204.0"}}}},"AllowBucketNotificationsToDocumentProcessingdevUploadIngestionHandlerIngestionTriggerFunction144535E3":{"id":"AllowBucketNotificationsToDocumentProcessingdevUploadIngestionHandlerIngestionTriggerFunction144535E3","path":"DocumentProcessing-dev/DocumentStorage/DocumentBucket/AllowBucketNotificationsToDocumentProcessingdevUploadIngestionHandlerIngestionTriggerFunction144535E3","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["UploadIngestionHandlerIngestionTriggerFunction8445C5EA","Arn"]},"principal":"s3.amazonaws.com","sourceAccount":"519610608202","sourceArn":{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]}}}},"Policy":{"id":"Policy","path":"DocumentProcessing-dev/DocumentStorage/DocumentBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/DocumentStorage/DocumentBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"DocumentStorageDocumentBucket03F69AFE"},"policyDocument":{"Statement":[{"Action":["s3:GetObject","s3:ListBucket"],"Effect":"Allow","Principal":{"Service":"bedrock.amazonaws.com"},"Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/formatted/*"]]}]}],"Version":"2012-10-17"}}}}}}}}}},"DocumentJobTable":{"id":"DocumentJobTable","path":"DocumentProcessing-dev/DocumentJobTable","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"DocumentJobTable":{"id":"DocumentJobTable","path":"DocumentProcessing-dev/DocumentJobTable/DocumentJobTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/DocumentJobTable/DocumentJobTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"documentId","attributeType":"S"},{"attributeName":"timestamp","attributeType":"S"},{"attributeName":"bucket","attributeType":"S"},{"attributeName":"key","attributeType":"S"},{"attributeName":"status","attributeType":"S"},{"attributeName":"jobId","attributeType":"S"},{"attributeName":"textractJobId","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"BucketKeyIndex","keySchema":[{"attributeName":"bucket","keyType":"HASH"},{"attributeName":"key","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"StatusIndex","keySchema":[{"attributeName":"status","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"DocumentIdIndex","keySchema":[{"attributeName":"documentId","keyType":"HASH"}],"projection":{"projectionType":"ALL"}},{"indexName":"JobIdIndex","keySchema":[{"attributeName":"jobId","keyType":"HASH"}],"projection":{"projectionType":"ALL"}},{"indexName":"TextractJobIdIndex","keySchema":[{"attributeName":"textractJobId","keyType":"HASH"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"documentId","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"tableName":"document-jobs-dev"}}},"ScalingRole":{"id":"ScalingRole","path":"DocumentProcessing-dev/DocumentJobTable/DocumentJobTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}}}}}},"IngestionQueue":{"id":"IngestionQueue","path":"DocumentProcessing-dev/IngestionQueue","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"DeadLetterQueue":{"id":"DeadLetterQueue","path":"DocumentProcessing-dev/IngestionQueue/DeadLetterQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/IngestionQueue/DeadLetterQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600,"queueName":"document-ingestion-dev-dlq","sqsManagedSseEnabled":true}}}}},"Queue":{"id":"Queue","path":"DocumentProcessing-dev/IngestionQueue/Queue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/IngestionQueue/Queue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":345600,"queueName":"document-ingestion-dev","redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["IngestionQueueDeadLetterQueue5AA5A009","Arn"]},"maxReceiveCount":3},"sqsManagedSseEnabled":true,"visibilityTimeout":300}}}}}}},"ClassificationQueue":{"id":"ClassificationQueue","path":"DocumentProcessing-dev/ClassificationQueue","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"DeadLetterQueue":{"id":"DeadLetterQueue","path":"DocumentProcessing-dev/ClassificationQueue/DeadLetterQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/ClassificationQueue/DeadLetterQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600,"queueName":"document-classification-dev-dlq","sqsManagedSseEnabled":true}}}}},"Queue":{"id":"Queue","path":"DocumentProcessing-dev/ClassificationQueue/Queue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/ClassificationQueue/Queue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":345600,"queueName":"document-classification-dev","redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["ClassificationQueueDeadLetterQueueDE207F8C","Arn"]},"maxReceiveCount":3},"sqsManagedSseEnabled":true,"visibilityTimeout":300}}}}}}},"BedrockKnowledgeBaseRole":{"id":"BedrockKnowledgeBaseRole","path":"DocumentProcessing-dev/BedrockKnowledgeBaseRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportBedrockKnowledgeBaseRole":{"id":"ImportBedrockKnowledgeBaseRole","path":"DocumentProcessing-dev/BedrockKnowledgeBaseRole/ImportBedrockKnowledgeBaseRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/BedrockKnowledgeBaseRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"bedrock.amazonaws.com"}}],"Version":"2012-10-17"},"description":"Role for Bedrock to access resources for knowledge base operations"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/BedrockKnowledgeBaseRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/BedrockKnowledgeBaseRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/formatted/*"]]}]}],"Version":"2012-10-17"},"policyName":"BedrockKnowledgeBaseRoleDefaultPolicy3434A684","roles":[{"Ref":"BedrockKnowledgeBaseRole24C5E17B"}]}}}}}}},"TextractService":{"id":"TextractService","path":"DocumentProcessing-dev/TextractService","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"TextractServiceRole":{"id":"TextractServiceRole","path":"DocumentProcessing-dev/TextractService/TextractServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportTextractServiceRole":{"id":"ImportTextractServiceRole","path":"DocumentProcessing-dev/TextractService/TextractServiceRole/ImportTextractServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractService/TextractServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"textract.amazonaws.com"}}],"Version":"2012-10-17"},"description":"Role for Amazon Textract to access resources"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/TextractService/TextractServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractService/TextractServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/*"]]}]},{"Action":"sns:Publish","Effect":"Allow","Resource":{"Ref":"TextractServiceTextractCompletionHandlerTopicF22705D3"}}],"Version":"2012-10-17"},"policyName":"TextractServiceTextractServiceRoleDefaultPolicy9D70CF22","roles":[{"Ref":"TextractServiceTextractServiceRole3966751E"}]}}}}}}},"TextractCompletionHandlerTopic":{"id":"TextractCompletionHandlerTopic","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"Textract Job Completion Notifications"}}}}},"TextractCompletionHandlerDLQ":{"id":"TextractCompletionHandlerDLQ","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerDLQ","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerDLQ/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600}}}}},"TextractCompletionHandlerQueue":{"id":"TextractCompletionHandlerQueue","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":604800,"redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["TextractServiceTextractCompletionHandlerDLQF5847860","Arn"]},"maxReceiveCount":3},"visibilityTimeout":300}}},"Policy":{"id":"Policy","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerQueue/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.QueuePolicy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerQueue/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueuePolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::QueuePolicy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"sqs:SendMessage","Condition":{"ArnEquals":{"aws:SourceArn":{"Ref":"TextractServiceTextractCompletionHandlerTopicF22705D3"}}},"Effect":"Allow","Principal":{"Service":"sns.amazonaws.com"},"Resource":{"Fn::GetAtt":["TextractServiceTextractCompletionHandlerQueueCCA79AAC","Arn"]}}],"Version":"2012-10-17"},"queues":[{"Ref":"TextractServiceTextractCompletionHandlerQueueCCA79AAC"}]}}}}},"DocumentProcessingdevTextractServiceTextractCompletionHandlerTopic522727CA":{"id":"DocumentProcessingdevTextractServiceTextractCompletionHandlerTopic522727CA","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerQueue/DocumentProcessingdevTextractServiceTextractCompletionHandlerTopic522727CA","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Subscription","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractService/TextractCompletionHandlerQueue/DocumentProcessingdevTextractServiceTextractCompletionHandlerTopic522727CA/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnSubscription","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Subscription","aws:cdk:cloudformation:props":{"endpoint":{"Fn::GetAtt":["TextractServiceTextractCompletionHandlerQueueCCA79AAC","Arn"]},"protocol":"sqs","topicArn":{"Ref":"TextractServiceTextractCompletionHandlerTopicF22705D3"}}}}}}}}}},"UploadIngestionHandler":{"id":"UploadIngestionHandler","path":"DocumentProcessing-dev/UploadIngestionHandler","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"IngestionTriggerFunction":{"id":"IngestionTriggerFunction","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/*"]]}]},{"Action":["sqs:SendMessage","sqs:GetQueueAttributes","sqs:GetQueueUrl"],"Effect":"Allow","Resource":{"Fn::GetAtt":["IngestionQueue781421A8","Arn"]}}],"Version":"2012-10-17"},"policyName":"UploadIngestionHandlerIngestionTriggerFunctionServiceRoleDefaultPolicy5337D2CF","roles":[{"Ref":"UploadIngestionHandlerIngestionTriggerFunctionServiceRole70459819"}]}}}}}}},"Code":{"id":"Code","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.204.0"},"children":{"Stage":{"id":"Stage","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"AssetBucket":{"id":"AssetBucket","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.204.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/IngestionTriggerFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-519610608202-us-east-1","s3Key":"01a21873f4c47e1dc086926959d4e15323e790b55d8ff2f0c837e670c5c20602.zip"},"environment":{"variables":{"SQS_QUEUE_URL":{"Ref":"IngestionQueue781421A8"}}},"handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["UploadIngestionHandlerIngestionTriggerFunctionServiceRole70459819","Arn"]},"runtime":"nodejs18.x","timeout":30}}}}},"UploadFunction":{"id":"UploadFunction","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"UploadIngestionHandlerUploadFunctionServiceRoleDefaultPolicyCDBB4C6E","roles":[{"Ref":"UploadIngestionHandlerUploadFunctionServiceRole6A2817EE"}]}}}}}}},"Code":{"id":"Code","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.204.0"},"children":{"Stage":{"id":"Stage","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"AssetBucket":{"id":"AssetBucket","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.204.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/UploadFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-519610608202-us-east-1","s3Key":"8ddc4ccda2369deb9774622d936930c476c08acf429bf865b248204e00dadc96.zip"},"environment":{"variables":{"S3_BUCKET_NAME":{"Ref":"DocumentStorageDocumentBucket03F69AFE"}}},"handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["UploadIngestionHandlerUploadFunctionServiceRole6A2817EE","Arn"]},"runtime":"nodejs18.x","timeout":30}}}}},"PresignedUrlFunction":{"id":"PresignedUrlFunction","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:PutObject","s3:PutObjectAcl","s3:GetObject","s3:ListBucket"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/*"]]}]},{"Action":["s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"UploadIngestionHandlerPresignedUrlFunctionServiceRoleDefaultPolicy105204E7","roles":[{"Ref":"UploadIngestionHandlerPresignedUrlFunctionServiceRole20BF192A"}]}}}}}}},"Code":{"id":"Code","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.204.0"},"children":{"Stage":{"id":"Stage","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"AssetBucket":{"id":"AssetBucket","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.204.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/PresignedUrlFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-519610608202-us-east-1","s3Key":"9f9bbb4f873fb006331704ce7afd8d542ff2bb0f77b73c948805c6d010bd09ed.zip"},"environment":{"variables":{"S3_BUCKET_NAME":{"Ref":"DocumentStorageDocumentBucket03F69AFE"}}},"handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["UploadIngestionHandlerPresignedUrlFunctionServiceRole20BF192A","Arn"]},"runtime":"nodejs18.x","timeout":30}}}}},"DocumentAPI":{"id":"DocumentAPI","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"binaryMediaTypes":["*/*"],"description":"API for document processing and uploads","minimumCompressionSize":0,"name":"Document Processing API"}}},"CloudWatchRole":{"id":"CloudWatchRole","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/CloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/CloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}}}}},"Account":{"id":"Account","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Account","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["UploadIngestionHandlerDocumentAPICloudWatchRole1D294574","Arn"]}}}},"Deployment":{"id":"Deployment","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"API for document processing and uploads","restApiId":{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"}}}}}},"DeploymentStage.prod":{"id":"DeploymentStage.prod","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/DeploymentStage.prod","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/DeploymentStage.prod/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"UploadIngestionHandlerDocumentAPIDeploymentC0E0C32069e8c8db2f469add7fef0bf54478904c"},"restApiId":{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"},"stageName":"prod"}}}}},"Endpoint":{"id":"Endpoint","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"Default":{"id":"Default","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.204.0","metadata":[]},"children":{"OPTIONS":{"id":"OPTIONS","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Max-Age":"'86400'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Max-Age":true}}],"resourceId":{"Fn::GetAtt":["UploadIngestionHandlerDocumentAPI8CAB0BA8","RootResourceId"]},"restApiId":{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"}}}}}},"upload":{"id":"upload","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/upload","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/upload/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["UploadIngestionHandlerDocumentAPI8CAB0BA8","RootResourceId"]},"pathPart":"upload","restApiId":{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"}}}},"OPTIONS":{"id":"OPTIONS","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/upload/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/upload/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Max-Age":"'86400'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Max-Age":true}}],"resourceId":{"Ref":"UploadIngestionHandlerDocumentAPIuploadDA215FF5"},"restApiId":{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"}}}}}},"POST":{"id":"POST","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/upload/POST","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.204.0","metadata":[]},"children":{"ApiPermission.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.POST..upload":{"id":"ApiPermission.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.POST..upload","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/upload/POST/ApiPermission.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.POST..upload","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["UploadIngestionHandlerUploadFunction828F314A","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:519610608202:",{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"},"/",{"Ref":"UploadIngestionHandlerDocumentAPIDeploymentStageprod665729C8"},"/POST/upload"]]}}}},"ApiPermission.Test.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.POST..upload":{"id":"ApiPermission.Test.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.POST..upload","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/upload/POST/ApiPermission.Test.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.POST..upload","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["UploadIngestionHandlerUploadFunction828F314A","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:519610608202:",{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"},"/test-invoke-stage/POST/upload"]]}}}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/upload/POST/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"POST","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["UploadIngestionHandlerUploadFunction828F314A","Arn"]},"/invocations"]]},"contentHandling":"CONVERT_TO_BINARY","integrationHttpMethod":"POST"},"resourceId":{"Ref":"UploadIngestionHandlerDocumentAPIuploadDA215FF5"},"restApiId":{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"}}}}}}}},"presigned-url":{"id":"presigned-url","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/presigned-url","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/presigned-url/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["UploadIngestionHandlerDocumentAPI8CAB0BA8","RootResourceId"]},"pathPart":"presigned-url","restApiId":{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"}}}},"OPTIONS":{"id":"OPTIONS","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/presigned-url/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/presigned-url/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Max-Age":"'86400'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Max-Age":true}}],"resourceId":{"Ref":"UploadIngestionHandlerDocumentAPIpresignedurlB8975279"},"restApiId":{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"}}}}}},"GET":{"id":"GET","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/presigned-url/GET","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.204.0","metadata":[]},"children":{"ApiPermission.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.GET..presigned-url":{"id":"ApiPermission.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.GET..presigned-url","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/presigned-url/GET/ApiPermission.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.GET..presigned-url","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["UploadIngestionHandlerPresignedUrlFunctionD671FD17","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:519610608202:",{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"},"/",{"Ref":"UploadIngestionHandlerDocumentAPIDeploymentStageprod665729C8"},"/GET/presigned-url"]]}}}},"ApiPermission.Test.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.GET..presigned-url":{"id":"ApiPermission.Test.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.GET..presigned-url","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/presigned-url/GET/ApiPermission.Test.DocumentProcessingdevUploadIngestionHandlerDocumentAPID7C3312A.GET..presigned-url","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["UploadIngestionHandlerPresignedUrlFunctionD671FD17","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:519610608202:",{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"},"/test-invoke-stage/GET/presigned-url"]]}}}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/DocumentAPI/Default/presigned-url/GET/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"GET","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["UploadIngestionHandlerPresignedUrlFunctionD671FD17","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"UploadIngestionHandlerDocumentAPIpresignedurlB8975279"},"restApiId":{"Ref":"UploadIngestionHandlerDocumentAPI8CAB0BA8"}}}}}}}}}}}},"ApiGatewayCloudWatchRole":{"id":"ApiGatewayCloudWatchRole","path":"DocumentProcessing-dev/UploadIngestionHandler/ApiGatewayCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportApiGatewayCloudWatchRole":{"id":"ImportApiGatewayCloudWatchRole","path":"DocumentProcessing-dev/UploadIngestionHandler/ApiGatewayCloudWatchRole/ImportApiGatewayCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/UploadIngestionHandler/ApiGatewayCloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}}}}},"ApiGatewayAccount":{"id":"ApiGatewayAccount","path":"DocumentProcessing-dev/UploadIngestionHandler/ApiGatewayAccount","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["UploadIngestionHandlerApiGatewayCloudWatchRole4FF3DCFA","Arn"]}}}}}},"BucketNotificationsHandler050a0587b7544547bf325f094a3db834":{"id":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834","path":"DocumentProcessing-dev/BucketNotificationsHandler050a0587b7544547bf325f094a3db834","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Role":{"id":"Role","path":"DocumentProcessing-dev/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"DocumentProcessing-dev/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"s3:PutBucketNotification","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36","roles":[{"Ref":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC"}]}}}}}}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.204.0"}}}},"DocumentProcessor":{"id":"DocumentProcessor","path":"DocumentProcessing-dev/DocumentProcessor","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"DocumentProcessorFunction":{"id":"DocumentProcessorFunction","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["sqs:ReceiveMessage","sqs:ChangeMessageVisibility","sqs:GetQueueUrl","sqs:DeleteMessage","sqs:GetQueueAttributes"],"Effect":"Allow","Resource":{"Fn::GetAtt":["IngestionQueue781421A8","Arn"]}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentJobTable0E69761F","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentJobTable0E69761F","Arn"]},"/index/*"]]}]},{"Action":"iam:PassRole","Effect":"Allow","Resource":{"Fn::GetAtt":["TextractServiceTextractServiceRole3966751E","Arn"]}},{"Action":["textract:StartDocumentAnalysis","textract:StartDocumentTextDetection","textract:AnalyzeDocument","textract:DetectDocumentText","textract:GetDocumentAnalysis","textract:GetDocumentTextDetection"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"DocumentProcessorDocumentProcessorFunctionServiceRoleDefaultPolicy0C00E787","roles":[{"Ref":"DocumentProcessorDocumentProcessorFunctionServiceRole2D3A2BB7"}]}}}}}}},"Code":{"id":"Code","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.204.0"},"children":{"Stage":{"id":"Stage","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"AssetBucket":{"id":"AssetBucket","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.204.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-519610608202-us-east-1","s3Key":"40a8b43dc89a357b85d13873a11274a17046c386ebb762cad54394f2dc2a1a10.zip"},"environment":{"variables":{"DOCUMENTS_TABLE":{"Ref":"DocumentJobTable0E69761F"},"DYNAMODB_TABLE":{"Ref":"DocumentJobTable0E69761F"},"DOCUMENT_BUCKET":{"Ref":"DocumentStorageDocumentBucket03F69AFE"},"TEXTRACT_SNS_TOPIC_ARN":{"Ref":"TextractServiceTextractCompletionHandlerTopicF22705D3"},"TEXTRACT_ROLE_ARN":{"Fn::GetAtt":["TextractServiceTextractServiceRole3966751E","Arn"]}}},"handler":"index.handler","memorySize":1024,"role":{"Fn::GetAtt":["DocumentProcessorDocumentProcessorFunctionServiceRole2D3A2BB7","Arn"]},"runtime":"nodejs18.x","timeout":300}}},"SqsEventSource:DocumentProcessingdevIngestionQueue774F3C22":{"id":"SqsEventSource:DocumentProcessingdevIngestionQueue774F3C22","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/SqsEventSource:DocumentProcessingdevIngestionQueue774F3C22","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/DocumentProcessor/DocumentProcessorFunction/SqsEventSource:DocumentProcessingdevIngestionQueue774F3C22/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":10,"eventSourceArn":{"Fn::GetAtt":["IngestionQueue781421A8","Arn"]},"functionName":{"Ref":"DocumentProcessorDocumentProcessorFunction608C542F"},"functionResponseTypes":["ReportBatchItemFailures"],"maximumBatchingWindowInSeconds":30}}}}}}}}},"TextractCompletionHandler":{"id":"TextractCompletionHandler","path":"DocumentProcessing-dev/TextractCompletionHandler","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"TextractCompletionHandlerFunction":{"id":"TextractCompletionHandlerFunction","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentJobTable0E69761F","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentJobTable0E69761F","Arn"]},"/index/*"]]}]},{"Action":["sqs:SendMessage","sqs:GetQueueAttributes","sqs:GetQueueUrl"],"Effect":"Allow","Resource":{"Fn::GetAtt":["ClassificationQueueADADD6EE","Arn"]}},{"Action":["textract:GetDocumentAnalysis","textract:GetDocumentTextDetection"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"TextractCompletionHandlerTextractCompletionHandlerFunctionServiceRoleDefaultPolicy1BC33D83","roles":[{"Ref":"TextractCompletionHandlerTextractCompletionHandlerFunctionServiceRole6EDCD4E9"}]}}}}}}},"Code":{"id":"Code","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.204.0"},"children":{"Stage":{"id":"Stage","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"AssetBucket":{"id":"AssetBucket","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.204.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-519610608202-us-east-1","s3Key":"3d85574bdc54aa610d7f6faea2805cab10829c513013da7bc23d09de8da1a99b.zip"},"environment":{"variables":{"DOCUMENTS_TABLE":{"Ref":"DocumentJobTable0E69761F"},"DOCUMENT_BUCKET":{"Ref":"DocumentStorageDocumentBucket03F69AFE"},"SQS_CLASSIFICATION_QUEUE_URL":{"Ref":"ClassificationQueueADADD6EE"},"DYNAMODB_TABLE":{"Ref":"DocumentJobTable0E69761F"}}},"handler":"index.handler","memorySize":1024,"role":{"Fn::GetAtt":["TextractCompletionHandlerTextractCompletionHandlerFunctionServiceRole6EDCD4E9","Arn"]},"runtime":"nodejs18.x","timeout":300}}},"AllowInvoke:DocumentProcessingdevTextractServiceTextractCompletionHandlerTopic522727CA":{"id":"AllowInvoke:DocumentProcessingdevTextractServiceTextractCompletionHandlerTopic522727CA","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/AllowInvoke:DocumentProcessingdevTextractServiceTextractCompletionHandlerTopic522727CA","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["TextractCompletionHandlerTextractCompletionHandlerFunctionD75B0C0C","Arn"]},"principal":"sns.amazonaws.com","sourceArn":{"Ref":"TextractServiceTextractCompletionHandlerTopicF22705D3"}}}},"TextractCompletionHandlerTopic":{"id":"TextractCompletionHandlerTopic","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/TextractCompletionHandlerTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Subscription","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/TextractCompletionHandler/TextractCompletionHandlerFunction/TextractCompletionHandlerTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnSubscription","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Subscription","aws:cdk:cloudformation:props":{"endpoint":{"Fn::GetAtt":["TextractCompletionHandlerTextractCompletionHandlerFunctionD75B0C0C","Arn"]},"protocol":"lambda","topicArn":{"Ref":"TextractServiceTextractCompletionHandlerTopicF22705D3"}}}}}}}}}},"KnowledgeBase":{"id":"KnowledgeBase","path":"DocumentProcessing-dev/KnowledgeBase","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"KnowledgeBaseId":{"id":"KnowledgeBaseId","path":"DocumentProcessing-dev/KnowledgeBase/KnowledgeBaseId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}}}},"VectorSearchCollection":{"id":"VectorSearchCollection","path":"DocumentProcessing-dev/VectorSearchCollection","constructInfo":{"fqn":"aws-cdk-lib.aws_opensearchserverless.CfnCollection","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::OpenSearchServerless::Collection","aws:cdk:cloudformation:props":{"description":"OpenSearch Serverless collection for document vector embeddings","name":"docproc-dev-vector","type":"VECTORSEARCH"}}},"VectorSearchAccessPolicy":{"id":"VectorSearchAccessPolicy","path":"DocumentProcessing-dev/VectorSearchAccessPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_opensearchserverless.CfnAccessPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::OpenSearchServerless::AccessPolicy","aws:cdk:cloudformation:props":{"description":"Access policy for vector search collection","name":"docproc-dev-access","policy":{"Fn::Join":["",["[{\"Rules\":[{\"ResourceType\":\"collection\",\"Resource\":[\"collection/docproc-dev-vector\"],\"Permission\":[\"aoss:CreateCollectionItems\",\"aoss:DeleteCollectionItems\",\"aoss:UpdateCollectionItems\",\"aoss:DescribeCollectionItems\"]}],\"Principal\":[\"",{"Fn::GetAtt":["BedrockKnowledgeBaseRole24C5E17B","Arn"]},"\"]}]"]]},"type":"data"}}},"VectorSearchSecurityPolicy":{"id":"VectorSearchSecurityPolicy","path":"DocumentProcessing-dev/VectorSearchSecurityPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_opensearchserverless.CfnSecurityPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::OpenSearchServerless::SecurityPolicy","aws:cdk:cloudformation:props":{"description":"Security policy for vector search collection","name":"docproc-dev-security","policy":"{\"Rules\":[{\"ResourceType\":\"collection\",\"Resource\":[\"collection/docproc-dev-vector\"]}],\"AWSOwnedKey\":true}","type":"encryption"}}},"ClassificationHandler":{"id":"ClassificationHandler","path":"DocumentProcessing-dev/ClassificationHandler","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"BedrockKnowledgeBaseRole":{"id":"BedrockKnowledgeBaseRole","path":"DocumentProcessing-dev/ClassificationHandler/BedrockKnowledgeBaseRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportBedrockKnowledgeBaseRole":{"id":"ImportBedrockKnowledgeBaseRole","path":"DocumentProcessing-dev/ClassificationHandler/BedrockKnowledgeBaseRole/ImportBedrockKnowledgeBaseRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/ClassificationHandler/BedrockKnowledgeBaseRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"bedrock.amazonaws.com"}}],"Version":"2012-10-17"},"description":"Role for Bedrock to access resources for knowledge base operations"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/ClassificationHandler/BedrockKnowledgeBaseRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/ClassificationHandler/BedrockKnowledgeBaseRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/formatted/*"]]}]}],"Version":"2012-10-17"},"policyName":"ClassificationHandlerBedrockKnowledgeBaseRoleDefaultPolicy93B8D3C8","roles":[{"Ref":"ClassificationHandlerBedrockKnowledgeBaseRoleA61F6254"}]}}}}}}},"ClassificationFunction":{"id":"ClassificationFunction","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["sqs:ReceiveMessage","sqs:ChangeMessageVisibility","sqs:GetQueueUrl","sqs:DeleteMessage","sqs:GetQueueAttributes"],"Effect":"Allow","Resource":{"Fn::GetAtt":["ClassificationQueueADADD6EE","Arn"]}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/*"]]}]},{"Action":["s3:PutObject","s3:GetObject","s3:ListBucket"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DocumentStorageDocumentBucket03F69AFE","Arn"]},"/formatted/*"]]}]},{"Action":["bedrock:InvokeModel","bedrock:InvokeModelWithResponseStream"],"Effect":"Allow","Resource":"*"},{"Action":["dynamodb:Query","dynamodb:GetItem","dynamodb:PutItem","dynamodb:UpdateItem"],"Effect":"Allow","Resource":["arn:aws:dynamodb:us-east-1:519610608202:table/document-jobs-*","arn:aws:dynamodb:us-east-1:519610608202:table/document-jobs-*/index/*"]},{"Action":["bedrock:RetrieveAndGenerate","bedrock-agent-runtime:RetrieveAndGenerate","bedrock:Retrieve","bedrock:GetKnowledgeBase","bedrock:ListKnowledgeBases","bedrock-agent:RetrieveAndGenerate","bedrock:CreateKnowledgeBase","bedrock:DeleteKnowledgeBase","bedrock:UpdateKnowledgeBase","iam:PassRole"],"Effect":"Allow","Resource":"*"},{"Action":["bedrock:RetrieveAndGenerate","bedrock-agent-runtime:RetrieveAndGenerate","bedrock:Retrieve","bedrock:GetKnowledgeBase"],"Effect":"Allow","Resource":"arn:aws:bedrock:us-east-1:519610608202:knowledge-base/kbuvklgwhs"},{"Action":"iam:PassRole","Effect":"Allow","Resource":{"Fn::GetAtt":["ClassificationHandlerBedrockKnowledgeBaseRoleA61F6254","Arn"]}}],"Version":"2012-10-17"},"policyName":"ClassificationHandlerClassificationFunctionServiceRoleDefaultPolicy35F4F4DB","roles":[{"Ref":"ClassificationHandlerClassificationFunctionServiceRoleDFFC6194"}]}}}}}}},"Code":{"id":"Code","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.204.0"},"children":{"Stage":{"id":"Stage","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"AssetBucket":{"id":"AssetBucket","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.204.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-519610608202-us-east-1","s3Key":"73b79a910515a30e9c1b2fe8a2f360b4c337c74a310e4371ce56bb060d5e4614.zip"},"environment":{"variables":{"DOCUMENT_BUCKET":{"Ref":"DocumentStorageDocumentBucket03F69AFE"},"BEDROCK_MODEL_ID":"anthropic.claude-3-sonnet-20240229-v1:0","SQS_CLASSIFICATION_QUEUE_URL":{"Ref":"ClassificationQueueADADD6EE"},"KNOWLEDGE_BASE_ID":"kbuvklgwhs","FORMATTED_PREFIX":"formatted/","KNOWLEDGE_BASE_ROLE_ARN":{"Fn::GetAtt":["ClassificationHandlerBedrockKnowledgeBaseRoleA61F6254","Arn"]},"EMBEDDING_MODEL_ARN":"arn:aws:bedrock:us-east-1::foundation-model/amazon.titan-embed-text-v1","OPENSEARCH_COLLECTION_ARN":"arn:aws:aoss:us-east-1:519610608202:collection/docproc-dev-vector","DYNAMODB_TABLE":"document-jobs-dev"}},"handler":"index.handler","memorySize":1024,"role":{"Fn::GetAtt":["ClassificationHandlerClassificationFunctionServiceRoleDFFC6194","Arn"]},"runtime":"nodejs18.x","timeout":300}}},"SqsEventSource:DocumentProcessingdevClassificationQueue4F3ABC63":{"id":"SqsEventSource:DocumentProcessingdevClassificationQueue4F3ABC63","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/SqsEventSource:DocumentProcessingdevClassificationQueue4F3ABC63","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DocumentProcessing-dev/ClassificationHandler/ClassificationFunction/SqsEventSource:DocumentProcessingdevClassificationQueue4F3ABC63/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":1,"eventSourceArn":{"Fn::GetAtt":["ClassificationQueueADADD6EE","Arn"]},"functionName":{"Ref":"ClassificationHandlerClassificationFunctionF4718CEB"},"maximumBatchingWindowInSeconds":10}}}}}}}}},"IngestionQueueUrl":{"id":"IngestionQueueUrl","path":"DocumentProcessing-dev/IngestionQueueUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"ClassificationQueueUrl":{"id":"ClassificationQueueUrl","path":"DocumentProcessing-dev/ClassificationQueueUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"ApiEndpoint":{"id":"ApiEndpoint","path":"DocumentProcessing-dev/ApiEndpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"DocumentBucket":{"id":"DocumentBucket","path":"DocumentProcessing-dev/DocumentBucket","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"DocumentProcessing-dev/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"DocumentProcessing-dev/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.204.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"DocumentProcessing-dev/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.204.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"DocumentProcessing-dev/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.204.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}